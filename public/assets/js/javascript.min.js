$(function(){$("section#articles a[href^='http']").attr("target","_blank");filter="*";$("li.all").hide();$("li.divider").hide();if(window.location.hash.length){filter="."+window.location.hash.substr(1);$.cookie("filter",filter,{expires:365});$("#filter li:not(.all) a").addClass("inactive");$("#filter a"+filter).removeClass("inactive")}else if($.cookie("filter")!==undefined){filter=$.cookie("filter").split(",");$("#filter li:not(.all) a").each(function(){filter.indexOf("."+$(this).parent().attr("class"))==-1&&$(this).addClass("inactive")});filter.length==1&&(window.location.hash=filter[0].substr(1));filter=filter.join(",")}if($("#filter a.inactive").size()){$("li.all").show();$("li.divider").show()}});$(window).load(function(){limit=25;$container=$("section#articles");$container.isotope({itemSelector:"article",layoutMode:"masonry",filter:filter}).addClass("loaded");$("#filter a").click(function(e){if($(this).parent().hasClass("all")){filter="*";$.removeCookie("filter");$("#filter a.inactive").removeClass("inactive")}else{if(e.altKey){$("#filter a").addClass("inactive");$(this).removeClass("inactive")}else{$(this).toggleClass("inactive");$("#filter a:not(.inactive)").size()||$("#filter a").removeClass("inactive")}filter=new Array;$("#filter a:not(.inactive)").each(function(){filter[filter.length]="."+$(this).parent().attr("class")});filter.length==1?window.location.hash=filter[0].substr(1):window.location.hash.length&&(window.location.hash="");filter=filter.join(",");$.cookie("filter",filter,{expires:365})}if($("#filter a.inactive").size()){$("li.all").show();$("li.divider").show()}else{$("li.all").hide();$("li.divider").hide()}$container.isotope({filter:filter})});$("#more button").click(function(){$.getJSON("/more/"+$("#articles article").size(),function(e){$.each(e,function(e,t){var e=moment.unix(t.time);$container.append('<article class="'+t.type+' unadded">'+"<header>"+t.header+"</header>"+t.content+"<footer>"+t.source+"&nbsp;"+'<time datetime="'+e.format()+'">'+e.format("MMM D, YYYY")+"</time>"+"</footer>"+"</article>")});$("section#articles a[href^='http://']").attr("target","_blank");$("article.unadded").imagesLoaded(function(){$("article.unadded").each(function(){$container.isotope("appended",$(this));$(this).removeClass("unadded")});$container.isotope()})})})});